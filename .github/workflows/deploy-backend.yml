name: Deploy Backend to Azure App Services  
  
on:  
  push:  
    branches: [main]  
  pull_request:  
    branches: [main]  
  
env:  
  PYTHON_VERSION: '3.11'  
  
jobs:  
  build-and-deploy-backend:  
    runs-on: ubuntu-latest  
  
    steps:  
      - name: Checkout code  
        uses: actions/checkout@v4  
  
      - name: Set up Python  
        uses: actions/setup-python@v4  
        with:  
          python-version: ${{ env.PYTHON_VERSION }}  
  
      - name: Install backend dependencies  
        run: |  
          cd backend  
          python -m pip install --upgrade pip  
          pip install -r requirements.txt  
  
      - name: Login to Azure  
        uses: azure/login@v1  
        with:  
          creds: ${{ secrets.AZURE_CREDENTIALS }}  
  
      - name: Deploy Backend to Azure Web App  
        uses: azure/webapps-deploy@v2  
        with:  
          app-name: ${{ secrets.AZURE_WEBAPP_NAME_BACKEND }}  
          package: './backend'  
          startup-command: 'uvicorn main:app --host 0.0.0.0 --port 8000'  
